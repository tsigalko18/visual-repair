\begin{algorithm}[tb]
\scriptsize
\DontPrintSemicolon % Some LaTeX compilers require you to use \dontprintsemicolon instead
\KwIn{$T$: A test case developed for web application $V$, $U$: the URL of subsequent version $V'$, $EX$: execution trace of $T$ when executed on $V$}
\KwOut{$T'$: A verified/repaired $T$ working on $V'$}
%\colorbox{lightgray}{/* Execution Trace collection */} \;
\textit{trace} $\gets$ loadExecutionTrace($EX$) \;
\textit{driver} $\gets$ loadApp($U$) \;
\textit{statements}, \textit{repairedStatements} $\gets$ getStatements(T) \;
 \ForEach{ test statement $st_i \in$ \textit{statements} }{%
  \textit{locator} $\gets$ getLocator($st_i$)\;
  \textit{\textit{visLocator}} $\gets$ getVisualLocator(\textit{trace}, $st_i$) \;
 \textit{\textit{DOMInfo}} $\gets$ getDOMInfo(\textit{trace}, $st_i$) \;
  \textit{webElement} $\gets$ \textit{driver}.findElement(\textit{locator})\;
  \HiLi{/* Manage non-selection of web element. */} \;
   \uIf{webElement == null} { 
     \textit{webElemVisual} $\gets$ \textsc{visualSearch}(\textit{driver}, $st_i$, \textit{visLocator}, \textit{DOMInfo})\;
     \uIf{\textit{webElemVisual} == null} {
       \textit{webElemVisual} $\gets$ \textsc{localCrawling}(\textit{driver}, $st_i$, \textit{visLocator}, \textit{DOMInfo})\;
       \uIf{\textit{webElemVisual} == null} {
       \textit{repairedStatements}.remove($st_i$)\;
       } \Else{
       \textit{newStmt} $\gets$ <\textsc{synthetizeLocator}(\textit{webElemVisual}), ``click'', ``''> \;
       \textit{repairedStatements}.addBefore($st_i$, \textit{newStmt}) \;
        }
     } \Else{
     updateLocator($st_i$, \textit{webElemVisual}) \;
      \textit{repairedStatements}.update($st_i$) \;
     }
   \HiLi{/* Manage mis-selection of web element. */} \;
   } \ElseIf{webElement $\neq$ null}{
      \textit{webElemVisual} $\gets$ \textsc{visualSearch}(\textit{driver}, $st_i$, \textit{visLocator}, \textit{DOMInfo})\;
     \textit{webElement} $\gets$ \textsc{verify}(\textit{webElement}, \textit{webElemVisual})\;
      \textit{repairedStatements}.update($st_i$, \textit{webElement}) \;
   }
   \HiLi{/* Suggest potential fix to assertions value. */} \;
    \If { getAction($st_i$) == ``assertion'' and getText($st_i$) $\neq$ webElement.getText() } {
         \textit{newStmt} $\gets$ <\textit{webElement}, ``getText'', webElement.getText()> \;
      	\textit{repairedStatements}.replace($st_i$,  \textit{newStmt}) \;
      }
         \textit{driver} $\gets$ \textsc{executeStatement}($st_i$, $V'$) \;
      	$T'$.add($st_i$) \;
 }
\Return{$T'$, \textit{repairedStatements}}\;
\caption{Visual-Augmented Test Execution}
\label{algo:alg1}
\end{algorithm}